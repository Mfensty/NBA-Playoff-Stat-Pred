---
title: "NBA Playoff Stat Predictions"
name: "Matthew Fenstermaker"
date: "5/23/2024"
output: html_notebook
---

*Note: Date is the when the data is edited. Players have been removed when teams lost, as they can no longer be factored in.*

*Available options for players include Jayson Tatum, Jaylen Brown, Jrue Holiday, Derrick White, Luka Doncic, Kyrie Irving, PJ Washington, Derick Lively, Daniel Gafford, Josh Green, Anthony Edwards, KAT, Jaden McDaniels, Rudy Gobert, and Mike Conley.*

```{r echo = T}
#Read in data and find running average of each category

#Final Average can be found by looking at the last game for each player

library(readxl)
library(dplyr)
nba <- read_excel("NBA DATA.xlsx")
nba <- nba %>%
  slice(-c(242,263)) #Removing Missed Games
nba <- na.omit(nba)
nba$Pts <- as.numeric(nba$Pts)
nba$Reb <- as.numeric(nba$Reb)
nba$Assists <- as.numeric(nba$Assists)
nba$`3PM` <- as.numeric(nba$`3PM`)

nba <- nba %>%
  group_by(Player) %>%
  mutate(
    Running_Avg_Pts = cumsum(Pts) / row_number(),
    Running_Avg_Reb = cumsum(Reb) / row_number(),
    Running_Avg_Assists = cumsum(Assists) / row_number(),
    Running_Avg_3PM = cumsum(`3PM`) / row_number()
  )
```

```{r echo = T}
#Create indicators for each player

DW <- nba %>%
  filter(Player == "Derrick White")
LD <- nba %>%
  filter(Player == "Luka Doncic")
AE <- nba %>%
  filter(Player == "Anthony Edwards")
JB <- nba %>%
  filter(Player == "Jaylen Brown")
PJ <- nba %>%
  filter(Player == "PJ Washington")
DL <- nba %>%
  filter(Player == "Dereck Lively")
DG <- nba %>%
  filter(Player == "Daniel Gafford")
MC <- nba %>%
  filter(Player == "Mike Conley")
RG <- nba %>%
  filter(Player == "Rudy Gobert")
JG <- nba %>%
  filter(Player == "Josh Green")
JH <- nba %>%
  filter(Player == "Jrue Holiday")
KT <- nba %>%
  filter(Player == "KAT")
JM <- nba %>%
  filter(Player == "Jaden McDaniels")
JT <- nba %>%
  filter(Player == "Jayson Tatum")
KI <- nba %>%
  filter(Player == "Kyrie Irving")
```

```{r echo = T}
#Show graphical analysis of each player with the respected stat line you wish 

library(ggplot2)
ggplot(JT, aes(x = JT$`Total Game`, y = Pts)) + #Use the indicator markers for player for the first argument after ggplot( and also after the x = 
  geom_line() +
  geom_point() +
  geom_line(aes(y = JT$RegSeasonPPG),color = "blue")+
  geom_smooth(method = "lm", se = FALSE, color = "red")+
  labs(title = "Pts for Desired Player", #Here you would insert the players name as well after "for" and the respective stat line you modeled
       x = "Game",
       y = "Points")
```

```{r echo = T}
#Confidence interval for desired player and the stat line wished upon

t.test(AE$Pts, conf.level = 0.30)$conf.int
```

```{r echo = T}
#Finding the percentage of how many times a player has done this kind of stat line in the playoffs

bet1 <- (sum(DG$Assists > 0.5 ) / nrow(DG))
bet2 <- (sum(AE$Pts < 27.5 ) / nrow(AE))
bet3 <- (sum(RG$Assists < 1.5 ) / nrow(RG))
bet4 <- (sum(RG$Reb > 10.5 ) / nrow(RG))
bet5 <- (sum(PJ$`3PM` > 1.5 ) / nrow(PJ))
bet6 <- (sum(LD$Pts >= 25 ) / nrow(LD))
bet1
bet2
bet3
bet4
bet5
bet6
```


```{r echo = T}
#Percentage change of hitting bet (Take all percentages above and add it to the numbers )

(bet1 * bet2 * bet3 * bet4 * bet5 * bet6)
```

